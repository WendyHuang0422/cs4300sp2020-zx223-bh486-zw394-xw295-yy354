{% extends "layout.html" %}
{% block content %}
<!-- <div class="search">
    <a href = "/">
        <img src = "/static/media/logo.jpg" class = "img-fluid" alt = "Tweeted Facts Logo" style="height: 50px;">
    </a>
    <form method="get" id="search-bar">
        <div class="col-md-8" id="bar">
            <input id="input" type="text" name="search" class="form-control" placeholder="Twitter Celebrity" value = "{{user}}" required>
        </div>
        <div>
            <button type="submit" class="btn btn-primary mb-2" >Fact Check &nbsp; <i class="far fa-search"></i></button>
        </div>
    </form>
</div> -->

<form action = "/results">
    <a href = "/">
        <img src = "/static/media/logo.jpg" class = "img-fluid" alt = "Tweeted Facts Logo" style="height: 50px;">
    </a>
    <div class="row d-flex justify-content-center" style = "margin-top: 10px">
        <div class="col-md-8">
            <input id="input" type="text" name="search" class="form-control" placeholder="Twitter Celebrity" value = "{{user}}" required>
        </div>
    </div>
    <div class="row d-flex justify-content-center" style = "margin-top: 5px">
        <div class="col-md-8">
            {% if topic%}
                <input id="input_2" type="text" name="terms" 
                class="form-control" placeholder="Topic or Keywords (optional)"
                value = "{{topic}}">
            {% else %}
                <input id="input_2" type="text" name="terms" 
                class="form-control" placeholder="Topic or Keywords (optional): feature coming soon!" disabled>
            {% endif %}
        </div>
    </div>
    <div class="row d-flex justify-content-center" style = "margin-top: 5px">
        <button type="submit" class="btn btn-primary mb-2" >Fact Check &nbsp; <i class="far fa-search"></i></button>
    </div>
</form>

<div class="row justify-content-md-center">
    <div class="col-lg" style = "margin-top: 10px; margin-bottom: 10px">

        {% if data %}
            <div class = "container" style = "margin-bottom: 3%">
                <h4 style = "font-size: 23.5px; margin-bottom: 5px">Latest tweets from @<a href="results.html" style = "color: #222222"><u>{{user}}</u></a>:</h4>
            </div>
            
            {% for i in range(length) %}  
                <a class="list-group-item list-group-item-action" href="results.html?search={{user}}&terms={{topic}}&idx={{i}}e" >
                    <div class="d-flex w-100 justify-content-between" style = "margin-bottom: 0px">
                        <h5 class="mb-1" style = "margin-bottom: 5px">{{user}}</h5>
                        <small class="text-muted">{{date[i]}}</small>
                    </div>
                    <p class="mb-1" style = "margin-top: 3px; margin-bottom: 3px">{{data[i]}}</p>
                    <small class="text-muted">
                        <i class="far fa-retweet"></i>&nbsp;{{retweets[i]}}&nbsp;&nbsp;
                        <i class="far fa-heart"></i>&nbsp;{{like[i]}}&nbsp;&nbsp;
                    <br></small>
                </a>
            {% endfor %}
        {% endif %}
    </div>

    <div class="col-lg" style = "margin-top: 10px; margin-bottom: 10px">
        {% if data %}
            <div class = "container" style = "margin-bottom: 3%">
                <h4 style = "color: #222222; font-size: 23.5px; margin-bottom: 5px">
                    {% if topic != None %}
                        Recent news articles related to {{topic}}:
                    {% else %}
                        Recent news articles:
                    {% endif %}
                </h4>
            </div>
            {% for i in range(length) %}  
                <a href="{{news_list[i][0][2]}}" class="list-group-item list-group-item-action">
                    {% if topic != None %}
                        {% if news_list[i][0][4] != None %}
                            <small class="text-muted" style = "margin-bottom: 5px;"><strong>Keyword: </strong>{{news_list[i][0][4]}}<br></small>
                        {% endif %}
                    {% endif %}
                    <div class="d-flex w-100 justify-content-between" style = "margin-bottom: 5px;">
                        <h6 class="mb-1">{{news_list[i][0][1]}}</h6>
                    </div>
                    <small class="text-muted"><strong>Source: </strong>{{news_list[i][0][0]}}<br></small>
                </a>
            {% endfor %}
        {% endif %}
        
    </div>
</div>

{% if error %}
    <div class = "container" style = "margin-bottom: 3%">
    {% for error_msg_entry in error %}  
        <h4 style = "margin-bottom: 5px">{{error_msg_entry}}</h4>
    {% endfor %}
    </div>
{% endif %}

<div class="card card-body" style = "margin-top: 100px; margin-bottom: 10px">
    <div class = "text-center text-muted">
    	You searched: [{{user}}, "{{topic}}"] <br>
        Returned in: {{time_taken}} seconds.
    	{{msg}} <br>
    </div>
</div>
{% endblock content %}